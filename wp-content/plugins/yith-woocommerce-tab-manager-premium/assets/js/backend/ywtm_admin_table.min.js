jQuery(document).ready(function(t){function e(e,a,o,n){for(var r=!0,i=0;i<a.length;i++){":radio"==a[i].substr(0,6)&&(a[i]=a[i]+":checked");var s=t(a[i]).val();if("checkbox"==t(a[i]).attr("type")){var l=t(a[i]);s=l.is(":checked")?"yes":"no"}if(!r||s!=o[i]){r=!1;break}r=!0}r?t(e+"-container").parent().show():t(e+"-container").parent().hide()}function a(t){return t.constructor.toString().indexOf("Array")>-1}t(".metaboxes-tab [data-dep-target]").each(function(){var o=t(this),n=o.data("dep-id").split(",");if(a(n)&&n.length>1){var r="#"+o.data("dep-target"),i=o.data("dep-value").split(",");e(r,n,i,!0);for(var s=0;s<n.length;s++)n[s]="#"+n[s];for(var s=0;s<n.length;s++)t(n[s]).on("change",function(){e(r,n,i,!1)}).change()}}),t(".ywtm_description.show_more").each(function(){var e=t(this).html(),a=t(this).data("max_char"),o=t(this).data("more_text");if(e.length>a){var n=e.substr(0,a),r=e.substr(a,e.length-a),i=n+'<span class="ywtm_morecontent"><span style="display: none;">'+r+'</span>&nbsp;&nbsp;<a href="" class="ywtm_morelink">'+o+"</a></span>";t(this).html(i)}}),t(".ywtm_morelink").click(function(){var e=t(this).parents(".ywtm_description"),a=e.data("more_text"),o=e.data("less_text");return t(this).hasClass("less")?(t(this).removeClass("less"),t(this).html(a)):(t(this).addClass("less"),t(this).html(o)),t(this).parent().prev().toggle("slow"),t(this).prev().toggle(),!1}),t("#_ywtm_icon_tab_select_icon_mode").on("change",function(e){var a=t(this),o=a.val(),n=t("#yit-icons-manager-wrapper-_ywtm_icon_tab_icon"),r=t("#_ywtm_icon_tab_custom").parent();"icon"==o?(n.show(),r.hide()):"upload"==o?(n.hide(),r.show()):(n.hide(),r.hide())}).trigger("change"),t(".ywtb-table").on("click","a.insert",function(e){var a=t(this).closest(".ywtb-table"),o="",n="";if(e.preventDefault(),a.length){a.hasClass("ywtb-video-table")?(o="video_row",n="#_ywtm_video-container"):a.hasClass("ywtb-download-table")?(o="download_row",n="#_ywtm_download-container"):(o="faq_row",n="#_ywtm_faqs-container");var r=a.find("tbody tr").size(),i={row:r,add_table_row:o,action:yith_tab_params.actions.add_table_row};t.ajax({type:"POST",url:yith_tab_params.admin_url,data:i,dataType:"json",success:function(e){var a=t(n).find(".ywtb-table tbody");a.append(e.result)}})}}),t(".ywtb-table tbody").sortable({items:"tr",cursor:"move",axis:"y",handle:"td.sort",scrollSensitivity:40,forcePlaceholderSize:!0,helper:"clone",opacity:.65}),t(".ywtb-table").on("click","a.delete",function(e){e.preventDefault(),t(this).closest("tr").remove()});var o,n;t(document.body).on("click",".upload_file_button",function(e){var a=t(this);if(n=a.closest("tr").find("td.file_url input"),e.preventDefault(),o)return void o.open();var r=[new wp.media.controller.Library({library:wp.media.query(),multiple:!0,title:a.data("choose"),priority:20,filterable:"uploaded"})];o=wp.media.frames.downloadable_file=wp.media({title:a.data("choose"),library:{type:""},button:{text:a.data("update")},multiple:!0,states:r}),o.on("select",function(){var t="",e=o.state().get("selection");e.map(function(e){e=e.toJSON(),e.url&&(t=e.url)}),n.val(t).change()}),o.on("ready",function(){o.uploader.options.uploader.params={type:"downloadable_product"}}),o.open()});var r=function(t){t.css("opacity","0.3"),t.css("pointer-events","none")},i=function(t){t.css("opacity","1"),t.css("pointer-events","auto")};t("#_ywtm_form_tab_name,#_ywtm_form_tab_website,#_ywtm_form_tab_subject").on("change",function(e){var a=t(this),o=a.attr("id");a.is(":checked")?i(t("#"+o+"_req").closest(".ywtb-field")):r(t("#"+o+"_req").closest(".ywtb-field"))}).trigger("change")});